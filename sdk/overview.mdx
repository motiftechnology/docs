---
title: "SDK Overview"
description: "Complete guide to the ChaterAfrika JavaScript SDK"
---

## Introduction

The ChaterAfrika JavaScript SDK is a headless SDK for integrating real-time chat, messaging, presence, and support features into your applications.

<Warning>
**Messages are sent exclusively over WebSockets.**

This guarantees ordering, real-time delivery, typing indicators, presence, and receipts.

Use `client.conversations.get(conversationId).sendMessage(content)` to send messages.

REST APIs are used for history, analytics, and internal automation only.
</Warning>

## Installation

```bash
npm install @chatafrika/sdk
```

## Quick Start

```typescript
import { ChatAfrika } from '@chatafrika/sdk';

// Initialize SDK
const client = new ChatAfrika({
  wsUrl: 'wss://ws.dev.chaterafrika.com',
  token: 'your-sdk-token',
  debug: true
});

// Connect to WebSocket
await client.connect();

// Join a conversation
await client.conversations.join('conversation-id');

// Get the conversation instance
const conversation = client.conversations.get('conversation-id');

// Listen for messages
conversation.on('message', (message) => {
  console.log('New message:', message.content);
});

// Send a message
conversation.sendMessage('Hello, world!');
```

## Core Features

### ✅ Real-time Messaging

- Send and receive messages instantly via WebSocket
- Optimistic message updates (instant UI feedback)
- Automatic message reconciliation with server
- Message deduplication

### ✅ Presence Management

- Track user online/offline status
- Real-time presence updates
- SDK-global presence tracking

### ✅ Typing Indicators

- Show when users are typing
- Automatic timeout (5 seconds)
- Per-conversation typing state

### ✅ Read Receipts

- Track message delivery
- Track message reads
- Receipt lifecycle management

### ✅ Support Sessions

- Customer/Agent role awareness
- Support session lifecycle
- Agent assignment tracking
- Bot handover management

### ✅ Connection Management

- Automatic reconnection
- Connection state tracking
- Token-based authentication
- Graceful disconnection

## SDK Architecture

```
ChatAfrika (Main Client)
├── conversations
│   ├── get(id) → Conversation
│   ├── has(id) → boolean
│   ├── join(id) → Promise
│   └── leave(id) → Promise
├── support
│   ├── get(id, role?) → SupportSession
│   └── has(id) → boolean
└── Events: connected, disconnected, error, presence

Conversation
├── id: string
├── isJoined: boolean
├── sendMessage(content, type?, metadata?)
├── startTyping()
├── stopTyping()
└── Events: message, typing, receipt, presence, joined, left
```

## Configuration

```typescript
interface ClientConfig {
  wsUrl: string;              // WebSocket URL (required)
  token: string;              // SDK token (required)
  apiUrl?: string;            // Backend API URL (optional)
  debug?: boolean;            // Enable debug logging
  autoReconnect?: boolean;    // Auto-reconnect on disconnect (default: true)
  maxReconnectAttempts?: number; // Max reconnect attempts (default: 5)
  reconnectDelay?: number;    // Reconnect delay in ms (default: 1000)
}
```

## API Reference

### ChatAfrika Client

```typescript
import { ChatAfrika } from '@chatafrika/sdk';

const client = new ChatAfrika({
  wsUrl: 'wss://ws.dev.chaterafrika.com',
  token: 'your-sdk-token'
});

// Connection
await client.connect();
await client.disconnect();
client.isConnected(); // boolean
client.getState(); // ConnectionState

// Token management
client.updateToken(newToken);

// Events
client.on('connected', () => { /* ... */ });
client.on('disconnected', (data) => { /* ... */ });
client.on('error', (error) => { /* ... */ });
client.on('presence', (event) => { /* ... */ });
```

### Conversations

```typescript
// Join a conversation
await client.conversations.join('conversation-id');

// Get conversation instance
const conversation = client.conversations.get('conversation-id');

// Check if exists
client.conversations.has('conversation-id'); // boolean

// Leave conversation
await client.conversations.leave('conversation-id');
```

### Conversation Instance

```typescript
const conversation = client.conversations.get('conversation-id');

// Properties
conversation.id;        // string
conversation.isJoined;  // boolean

// Send message
conversation.sendMessage('Hello!');
conversation.sendMessage('Hello!', 'text', { customField: 'value' });

// Typing indicators
conversation.startTyping();
conversation.stopTyping();

// Events
conversation.on('message', (message) => {
  console.log(message.id, message.content, message.senderId);
});

conversation.on('typing', (event) => {
  console.log(event.userId, event.state); // 'start' | 'stop'
});

conversation.on('receipt', (event) => {
  console.log(event.messageId, event.state); // 'delivered' | 'read'
});

conversation.on('joined', () => { /* ... */ });
conversation.on('left', () => { /* ... */ });
```

### Support Sessions

```typescript
// Get support session for a conversation
const support = client.support.get('conversation-id', 'customer');

// Check if exists
client.support.has('conversation-id'); // boolean
```

## Message Lifecycle

1. **Send Message** → Optimistic message created instantly
2. **Server Confirms** → Message reconciled with server data
3. **Delivered** → Delivery receipt received
4. **Read** → Read receipt received

```typescript
const conversation = client.conversations.get('conv-id');

// Send message (optimistic update happens immediately)
conversation.sendMessage('Hello!');

// Listen for receipt updates
conversation.on('receipt', (event) => {
  console.log(`Message ${event.messageId}: ${event.state}`);
  // 'delivered' or 'read'
});
```

## Error Handling

```typescript
// Connection errors
client.on('error', (error) => {
  console.error('SDK error:', error.message);
});

// Conversation errors
const conversation = client.conversations.get('conv-id');
conversation.on('error', (error) => {
  console.error('Conversation error:', error.message);
});

// Try-catch for async operations
try {
  await client.connect();
} catch (error) {
  console.error('Connection failed:', error);
}
```

## TypeScript Support

The SDK is written in TypeScript and includes full type definitions:

```typescript
import { 
  ChatAfrika, 
  Conversation,
  Message,
  ConnectionState 
} from '@chatafrika/sdk';

const client: ChatAfrika = new ChatAfrika({ /* config */ });
const conversation: Conversation = client.conversations.get('id');
```

## Complete Example

```typescript
import { ChatAfrika } from '@chatafrika/sdk';

async function initializeChat() {
  // Initialize SDK
  const client = new ChatAfrika({
    wsUrl: 'wss://ws.dev.chaterafrika.com',
    token: 'your-sdk-token',
    debug: true
  });

  // Handle connection events
  client.on('connected', () => console.log('Connected!'));
  client.on('disconnected', () => console.log('Disconnected'));
  client.on('error', (err) => console.error('Error:', err));

  // Connect
  await client.connect();

  // Join conversation
  const conversationId = 'your-conversation-id';
  await client.conversations.join(conversationId);

  // Get conversation instance
  const conversation = client.conversations.get(conversationId);

  // Listen for messages
  conversation.on('message', (message) => {
    console.log(`${message.senderId}: ${message.content}`);
  });

  // Listen for typing indicators
  conversation.on('typing', (event) => {
    if (event.state === 'start') {
      console.log(`${event.userId} is typing...`);
    } else {
      console.log(`${event.userId} stopped typing`);
    }
  });

  // Listen for receipts
  conversation.on('receipt', (event) => {
    console.log(`Message ${event.messageId} was ${event.state}`);
  });

  // Send a message
  conversation.sendMessage('Hello from ChaterAfrika!');

  return client;
}

// Initialize
initializeChat().catch(console.error);
```

## Next Steps

<CardGroup cols={2}>
  <Card title="Installation" icon="download" href="/sdk/installation">
    Installation and setup
  </Card>
  <Card title="Authentication" icon="key" href="/sdk/authentication">
    SDK authentication
  </Card>
  <Card title="Conversations" icon="comments" href="/sdk/conversations">
    Conversation management
  </Card>
  <Card title="Messaging" icon="message" href="/sdk/messaging">
    Sending and receiving messages
  </Card>
  <Card title="Presence" icon="user" href="/sdk/presence">
    Presence management
  </Card>
  <Card title="Examples" icon="code" href="/sdk/examples">
    Code examples
  </Card>
</CardGroup>
